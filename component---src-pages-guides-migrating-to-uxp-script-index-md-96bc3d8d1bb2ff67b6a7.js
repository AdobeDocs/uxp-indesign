"use strict";(self.webpackChunkuxp_indesign=self.webpackChunkuxp_indesign||[]).push([[1111],{38388:function(t,e,a){a.r(e),a.d(e,{_frontmatter:function(){return m},default:function(){return o}});var n=a(87462),r=a(45987),l=(a(15007),a(64983)),p=a(91515);const i=["components"],m={},d={_frontmatter:m},s=p.Z;function o(t){let{components:e}=t,a=(0,r.Z)(t,i);return(0,l.mdx)(s,(0,n.Z)({},d,a,{components:e,mdxType:"MDXLayout"}),(0,l.mdx)("h1",{id:"migrating-existing-javascriptextendscript-to-uxp-script"},"Migrating existing JavaScript(ExtendScript) to UXP Script"),(0,l.mdx)("p",null,"This page goes over how Javascripts can be converted to UXP script in simple steps."),(0,l.mdx)("ol",null,(0,l.mdx)("li",{parentName:"ol"},"Save the file with .idjs extension."),(0,l.mdx)("li",{parentName:"ol"},"Update the script for unsupported methods")),(0,l.mdx)("table",null,(0,l.mdx)("thead",{parentName:"table"},(0,l.mdx)("tr",{parentName:"thead"},(0,l.mdx)("th",{parentName:"tr",align:null},"SI"),(0,l.mdx)("th",{parentName:"tr",align:null},"Differences"),(0,l.mdx)("th",{parentName:"tr",align:null},"JavaScript(Objects also have ExtendScript)"),(0,l.mdx)("th",{parentName:"tr",align:null},"UXP Script"),(0,l.mdx)("th",{parentName:"tr",align:null},"Applicable To"))),(0,l.mdx)("tbody",{parentName:"table"},(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"SI"),(0,l.mdx)("td",{parentName:"tr",align:null},"Differences"),(0,l.mdx)("td",{parentName:"tr",align:null},"JavaScript(Objects also have ExtendScript)"),(0,l.mdx)("td",{parentName:"tr",align:null},"UXP Script"),(0,l.mdx)("td",{parentName:"tr",align:null},"Appicable To")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"1"),(0,l.mdx)("td",{parentName:"tr",align:null},"subscript operator ","[ ]",":Collection objects returned by InDesign like documents and paragraphs will not support subscript operator ","[ ]"," to access element at a particular index.The alternative is to use the method by name item()Objects like app.selection which is of type Array will support subscript operator."),(0,l.mdx)("td",{parentName:"tr",align:null},"for (j = 0; j ","<"," app.selection","[0]",".paragraphs.length; j++){"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","var"," "," item = app.selection","[0]",".paragraphs","[j]",";}"),(0,l.mdx)("td",{parentName:"tr",align:null},"for (j = 0; j ","<"," app.selection","[0]",".paragraphs.length; j++){"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","var"," "," item = app.selection","[0]",".paragraphs.item(j);}"),(0,l.mdx)("td",{parentName:"tr",align:null},"All Versions")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"2"),(0,l.mdx)("td",{parentName:"tr",align:null},'Object.constructor.name:Object.constructor.name which is a standard property in JS will return empty string ("") for InDesign scripting DOM objects. Alternative is to use the object.constructorName property.'),(0,l.mdx)("td",{parentName:"tr",align:null},"switch(myPageItem.constructor.name){"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ",' case "Rectangle":'," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ",' case "Oval":'," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ..."," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," break;"," "," "," ","}"),(0,l.mdx)("td",{parentName:"tr",align:null},"switch(myPageItem.constructorName){"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ",' case "Rectangle":'," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ",' case "Oval":'," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ..."," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," break;"," "," "," ","}"),(0,l.mdx)("td",{parentName:"tr",align:null},"Prior To 18.4")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"3"),(0,l.mdx)("td",{parentName:"tr",align:null},"Comparison operators(== and ===):Comparison operators(== and ===) on InDesign DOM objects will always return false unless the objects have same reference. Instead use method equals()"),(0,l.mdx)("td",{parentName:"tr",align:null},"if (myPath.pathType == PathType.closedPath) { ... }"),(0,l.mdx)("td",{parentName:"tr",align:null},"if (myPath.pathType.equals(PathType.closedPath)) { ... }"),(0,l.mdx)("td",{parentName:"tr",align:null},"All Versions")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"4"),(0,l.mdx)("td",{parentName:"tr",align:null},"instanceof:The instanceof keyword isn't supported for InDesign DOM objects. Instead using object.constructorName property."),(0,l.mdx)("td",{parentName:"tr",align:null},"if (app.selection","[0]",".paragraphs","[0]",".appliedParagraphStyle.parent instanceofParagraphStyleGroup) { ... }"),(0,l.mdx)("td",{parentName:"tr",align:null},"if (app.selection","[0]",'.paragraphs.item(0).parent.constructorName =="ParagraphStyleGroup") { ... }'),(0,l.mdx)("td",{parentName:"tr",align:null},"Prior To 18.4")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"5"),(0,l.mdx)("td",{parentName:"tr",align:null},"Global object 'document':global object 'document' is unsupported now instead use app.activeDocument"),(0,l.mdx)("td",{parentName:"tr",align:null},"document.findText()"),(0,l.mdx)("td",{parentName:"tr",align:null},"app.activeDocument.findText()"),(0,l.mdx)("td",{parentName:"tr",align:null},"All Versions")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"6"),(0,l.mdx)("td",{parentName:"tr",align:null},"ActiveScript: app.activeScript"),(0,l.mdx)("td",{parentName:"tr",align:null},"app.activeScript returns current running script as file object on which we can access other properties."),(0,l.mdx)("td",{parentName:"tr",align:null},"app.activeScript returns the path of the current script as a string. No other properties can be accessed on app.activeScript"," "),(0,l.mdx)("td",{parentName:"tr",align:null},"Prior To 18.4")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},"7"),(0,l.mdx)("td",{parentName:"tr",align:null},"Fetching the InDesign Server arguments passed to a script."),(0,l.mdx)("td",{parentName:"tr",align:null},'var myArg = app.scriptArgs.getValue("',(0,l.mdx)("em",{parentName:"td"},"argumentName"),'");'),(0,l.mdx)("td",{parentName:"tr",align:null},"let arguments = script.args; ",(0,l.mdx)("em",{parentName:"td"},(0,l.mdx)("a",{parentName:"em",href:"../../recipes/arguments/"},"Learn More"))),(0,l.mdx)("td",{parentName:"tr",align:null},"18.4 Onwards")))))}o.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-migrating-to-uxp-script-index-md-96bc3d8d1bb2ff67b6a7.js.map