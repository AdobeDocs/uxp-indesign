"use strict";(self.webpackChunkuxp_indesign=self.webpackChunkuxp_indesign||[]).push([[7871],{56601:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return o},default:function(){return u}});var l=t(87462),a=t(45987),r=(t(15007),t(64983)),s=t(91515);const d=["components"],o={},i={_frontmatter:o},p=s.Z;function u(e){let{components:n}=e,t=(0,a.Z)(e,d);return(0,r.mdx)(p,(0,l.Z)({},i,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"extendscript-to-uxp"},"ExtendScript to UXP"),(0,r.mdx)("p",null,"ExtendScript uses an older version of JavaScript (ES3). In contrast, UXP uses the V8 JavaScript engine which supports ES6; this has several notable features lacking in ExtendScript. "),(0,r.mdx)("p",null,"Not all the newer features of ES6 are used and/or supported in the UXP world, but as an ExtendScript developer, you should familiarize yourself with ECMAScript ES6 so you can understand the sample code."),(0,r.mdx)("p",null,"This page goes over how ExtendScript can be rewritten in UXP script in simple steps."),(0,r.mdx)("p",null,"For scripts,"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},"Save the file with ",(0,r.mdx)("inlineCode",{parentName:"li"},".idjs")," extension."),(0,r.mdx)("li",{parentName:"ol"},"Update the script for unsupported methods")),(0,r.mdx)("table",{columnWidths:"20,35,35,10"},(0,r.mdx)("thead",null,(0,r.mdx)("tr",null,(0,r.mdx)("th",null,"Differences"),(0,r.mdx)("th",null,"ExtendScript"),(0,r.mdx)("th",null,"UXP"),(0,r.mdx)("th",null,"Applicable To"))),(0,r.mdx)("tbody",null,(0,r.mdx)("tr",null,(0,r.mdx)("td",null,(0,r.mdx)("b",null,"subscript operator [ ]")," ",(0,r.mdx)("br",null),"Collection objects returned by InDesign like documents and paragraphs will not support subscript operator [ ] to access element at a particular index. The alternative is to use the method by name item()Objects like app.selection which is of type Array will support subscript operator."),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\nfor (j = 0; j < app.selection[0].paragraphs.length; j++) {\n    var item = app.selection[0].paragraphs[j];\n}\n")),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\nfor (j = 0; j < app.selection[0].paragraphs.length; j++) {\n    var item = app.selection[0].paragraphs.item(j);\n}\n")),(0,r.mdx)("td",null,"All Versions")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,(0,r.mdx)("b",null,"Object.constructor.name")," ",(0,r.mdx)("br",null),(0,r.mdx)("inlineCode",null,"Object.constructor.name"),' which is a standard property in JS will return an empty string ("") for DOM objects. Alternatively, use the ',(0,r.mdx)("inlineCode",null,"object.constructorName")," property."),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},'\nswitch(myPageItem.constructor.name) {\n    case "Rectangle":\n    case "Oval":\n        ...\n        break; \n}\n')),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},'\nswitch(myPageItem.constructorName) {\n    case "Rectangle":\n    case "Oval":\n        ...\n        break; \n}\n')),(0,r.mdx)("td",null,"Prior to v18.4")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,(0,r.mdx)("b",null,"Comparison operators(== and ===)"),(0,r.mdx)("br",null),"Comparison operators(== and ===) on InDesign DOM objects will always return false unless the objects have same reference. Instead use method equals()"),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\nif (myPath.pathType == PathType.closedPath) { ... }\n")),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\nif (myPath.pathType.equals(PathType.closedPath)) { ... }\n")),(0,r.mdx)("td",null," All Versions")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,(0,r.mdx)("b",null,"instanceof")," ",(0,r.mdx)("br",null),"The ",(0,r.mdx)("inlineCode",null,"instanceof")," keyword isn't supported for InDesign DOM objects. Instead using ",(0,r.mdx)("inlineCode",null,"object.constructorName")," property."),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\nif (app.selection[0].paragraphs[0].appliedParagraphStyle.parent instanceofParagraphStyleGroup) { ... }\n")),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},'\nif (app.selection[0].paragraphs.item(0).parent.constructorName == "ParagraphStyleGroup") { ... } \n')),(0,r.mdx)("td",null," Prior to v18.4")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,(0,r.mdx)("b",null,"Global object 'document'"),(0,r.mdx)("br",null),"Global object 'document' is not supported now. Instead, use ",(0,r.mdx)("inlineCode",null,"app.activeDocument")),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\ndocument.findText()\n")),(0,r.mdx)("td",null,(0,r.mdx)("code",{className:"language-javascript"},"\napp.activeDocument.findText()\n")),(0,r.mdx)("td",null," All Versions")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,"ActiveScript ",(0,r.mdx)("inlineCode",null,"app.activeScript")),(0,r.mdx)("td",null,(0,r.mdx)("inlineCode",null,"app.activeScript")," returns the current running script as a file object on which you can access other properties."),(0,r.mdx)("td",null,(0,r.mdx)("inlineCode",null,"app.activeScript")," returns the path of the current script as a string. No other properties can be accessed on ",(0,r.mdx)("inlineCode",null,"app.activeScript")),(0,r.mdx)("td",null,"Prior to v18.4")),(0,r.mdx)("tr",null,(0,r.mdx)("td",null,"Fetching the InDesign Server arguments passed to a script."),(0,r.mdx)("td",null,(0,r.mdx)("inlineCode",null,'var myArg = app.scriptArgs.getValue("*argumentName*");')),(0,r.mdx)("td",null,(0,r.mdx)("inlineCode",null,"let arguments = script.args;")," ",(0,r.mdx)("a",{href:"/indesign/uxp/scripts/tutorials/arguments/"},"Learn More")),(0,r.mdx)("td",null,"v18.4 Onwards")))))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-resources-migration-guides-extendscript-index-md-f04d827128ceac49ed6e.js.map